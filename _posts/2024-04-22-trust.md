---
layout: post
author: Quino
title: Trust , DOCKERLABS
tags:
  - cft
  - hacking
  - etico
categories: DockerLabs
comments: true
---

Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .

Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de ssh por fuerza bruta y escalada de privelegios.

## HERRAMIENTAS Y RECURSOS USADOS

- nmap
- hydra
- 
## Enumeracion

Como al arrancar la maquina ya nos dice la ip nos olvidamos de arp-scan , comprobamos la conexion con un ping.

```bash

ping -c1 172.17.0.2

```

Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.

```bash
sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertos
```

[Reporte](r3p0rt3s/trust_nmap.html "Reporte nmap")

  Observamos el resultado y vemos que solo tiene el 22 y el 80 abiertos .
Empecemos por revisar la web en el puerto que indica y nos encontramos con una web en la que bien claro nos da un posible usuario.

![web](assets/trust/web.png)

Empezamos por un ataque de fuerza bruta contra el usario mario haciendo uso de hydra dado que es mucho mas rapido que nxc.

```bash
hydra -l mario -P rockyou.txt -vV 172.17.02 ssh
```

![hydra](assets/trust/hydra.png)

## Infiltración

Ahora que ya tenemos todo listo pasamos a conectarnos a la maquina con el usario y la contraseña proporcionada por hydra.

![login_ssh](assets/trust/login_mario.png)

## Escalada de privilegios
  
Una vez dentro listamos lo primero es ejecutar como de costumbre que nos buscaran ficheros con permisos erroneos.

```bash
find / -perm -4000 2>/dev/null
sudo -l
```

El primer comando nos indica que podemos usar sudo así que comprobamos que es lo que nos permite ejecutar con la magia de sudo -l.

![salida_sudo](assets/trust/sudofind.png)

Como vemos tenemos el procesdor de texto vim que podemos usar como superusuario .
Asi que lanzamos el comando final para ser root.
Si no recordamos el comando cosultamos [GTOFBINS](https://gtfobins.github.io/ "gtofbins") o usuamos la herramienta searchbins que encontrareis en github.

```bash
sudo vim -c '!/bin/bash'
```

![imgroot](assets/trust/root.png)

Hasta aqui la maquina trust

Gracias por leer

